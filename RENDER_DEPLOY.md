# Деплой на Render.com

## Настройка переменных окружения

В панели Render.com добавьте следующие переменные окружения:

### Обязательные переменные:
- `DISCORD_TOKEN` - токен вашего Discord бота
- `CLIENT_ID` - ID вашего Discord приложения
- `SESSION_SECRET` - секретный ключ для сессий (будет сгенерирован автоматически)

### Опциональные переменные:
- `NODE_ENV` - установлено в `production` автоматически
- `PORT` - устанавливается Render автоматически

## Настройка деплоя

1. **Подключите GitHub репозиторий** к Render.com
2. **Выберите ветку** `restore-working-version` или `main`
3. **Build Command**: `npm install`
4. **Start Command**: `npm start`
5. **Environment**: `Node`
6. **Plan**: `Free` или `Starter`

## Структура проекта

```
├── server-production.js    # Главный файл для продакшена
├── bot/                   # Discord бот
│   ├── index.js          # Основной файл бота
│   ├── client.js         # Экспорт клиента для веб-панели
│   ├── commands/         # Slash команды
│   │   ├── stats.js      # Команда /stats
│   │   ├── embed.js      # Команда /embed
│   │   ├── help.js       # Команда /help
│   │   └── rules.js      # Команда /rules
│   ├── events/           # События Discord
│   │   ├── ready.js      # Событие готовности бота
│   │   └── guildMemberAdd.js # Приветствие новых участников
│   └── services/         # Сервисы
│       └── activityTracker.js # Отслеживание активности
├── web/                  # Веб-панель
│   ├── server.js         # Веб-сервер
│   ├── views/            # EJS шаблоны
│   └── public/           # Статические файлы
├── database/             # База данных
│   └── database.js       # Система базы данных
└── render.yaml           # Конфигурация Render
```

## Функциональность

### Discord бот:
- ✅ Slash команды (/stats, /embed, /help, /rules)
- ✅ Система кнопок выбора ролей с цветами
- ✅ Отслеживание активности пользователей
- ✅ Приветствие новых участников
- ✅ Отправка embed сообщений

### Веб-панель:
- ✅ Красивый дизайн в стиле ProBot
- ✅ Редактор embed сообщений
- ✅ Система кнопок ролей с выбором цвета
- ✅ Загрузка изображений
- ✅ Управление серверами
- ✅ API для Discord интеграции

## Проверка работы

После деплоя проверьте:

1. **Веб-панель**: `https://your-app.onrender.com/dashboard`
2. **Discord бот**: команда `/stats` на сервере
3. **Логи**: в панели Render.com

## Troubleshooting

### Если бот не подключается:
- Проверьте `DISCORD_TOKEN` в переменных окружения
- Убедитесь что токен действителен
- Проверьте логи в Render.com

### Если веб-панель не работает:
- Проверьте что `PORT` не задан вручную
- Render автоматически устанавливает порт
- Проверьте логи сборки

### Если изображения не загружаются:
- Render.com имеет эфемерную файловую систему
- Файлы могут исчезнуть при перезапуске
- Рассмотрите использование внешнего хранилища (Cloudinary, AWS S3)

## Команды для локальной разработки

```bash
# Запуск в режиме разработки (локально)
npm run local

# Запуск только бота
npm run bot

# Запуск только веб-панели
npm run web

# Запуск в продакшене (как на Render)
npm start
```